(function(){var a,b,c,d,e,f=[].slice,g=function(a,b){function c(){this.constructor=a}for(var d in b)h.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},h={}.hasOwnProperty;c=function(){function a(){var a,c,d,e,g;if(a=arguments[0],g=2<=arguments.length?f.call(arguments,1):[],this._instance=a,this._destination=this._instance._destination,this.context=this._instance.context,this._nodes=[],this.config_defaults={connect_to_destination:!0},this.config={},"string"===this.__typeof(g[0])&&"string"===this.__typeof(g[1])&&null!=b.LEGAL_NODES[g[1]])return new b.LEGAL_NODES[g[1]](this._instance,{id:g[0]});if(1===g.length){if("Node"!==this.constructor.name)return;if(null!=b.LEGAL_NODES[g[0].node_type])return new b.LEGAL_NODES[g[0].node_type](this._instance,g[0]);throw new Error("Omitted or undefined node type in config options.")}for(d=0,e=g.length;e>d;d++){if(c=g[d],!b.LEGAL_NODES[null!=g[c].node_type])throw new Error("Omitted or undefined node type in config options.");this._nodes.push(new b.LEGAL_NODES[g[c].node_type](this._instance,g[c]))}}return a.prototype.configure_from=function(a){var b,c,d;this.id=null!=a.id?a.id:this.new_id(),c=this.config_defaults;for(b in c)d=c[b],this.config[b]=b in a?a[b]:this.config_defaults[b];return this.config},a.prototype.zero_node_settings=function(a){var b,c,d;d={};for(b in a)c=a[b],b in this.config_defaults||"node_type"===b||"id"===b||(d[b]=c);return d},a.prototype.zero_node_setup=function(a){var b,c,d,e;this.expose_methods_of(this._nodes[0]),c=this.zero_node_settings(a),d=[];for(b in c)e=c[b],d.push(this.param(b,e));return d},a.prototype.toString=function(){return this.constructor.name+"#"+this.id},a.prototype.new_id=function(){return this.constructor.name+"_"+Math.round(1e5*Math.random())},a.prototype.__typeof=function(b){if(b instanceof AudioParam)return"AudioParam";if(b instanceof AudioNode)return"AudioNode";if(b instanceof a)return"Node";switch(typeof b){case"string":return"string";case"number":return"number";case"function":return"function";case"object":return"object";case"undefined":return"undefined";default:throw new Error("__typeof does not pass for "+typeof b)}},a.prototype.insert_node=function(a,b){var c;if(c=this._nodes.length,null==b&&(b=c),b>c)throw new Error("Invalid index given to insert_node: "+b+" out of "+c);return this.debug("insert_node of "+this+" for",a,b),0===b&&(this.connect_incoming(a),this.disconnect_incoming(this._nodes[0]),c>1&&(a.connect(this.to(this._nodes[0])),this.debug("- node.connect to ",this._nodes[0]))),b===c&&(0!==b&&this.safely_disconnect(this._nodes[b-1],this.from(this._destination)),0!==b&&this.debug("- disconnect ",this._nodes[b-1],"from",this._destination),this.config.connect_to_destination&&(a.connect(this.to(this._destination)),this.debug("- connect",a,"to",this._destination)),0!==b&&this._nodes[b-1].connect(this.to(a)),0!==b&&this.debug("- connect",this._nodes[b-1],"to",a)),b!==c&&0!==b&&(this.safely_disconnect(this._nodes[b-1],this.from(this._nodes[b])),this.debug("- disconnect",this._nodes[b-1],"from",this._nodes[b]),this._nodes[b-1].connect(this.to(a)),this.debug("- connect",this._nodes[b-1],"to",a),a.connect(this.to(this._nodes[b])),this.debug("- connect",a,"to",this._nodes[b])),this._nodes.splice(b,0,a),this.debug("- spliced:",this._nodes)},a.prototype.add=function(a){return this.insert_node(a)},a.prototype.connect_incoming=function(){},a.prototype.disconnect_incoming=function(){},a.prototype.connect=function(a,b,c,d){var e;switch(null==b&&(b=0),null==c&&(c=0),null==d&&(d=!0),this.debug("called connect from "+this+" to "+a+", "+b),this.__typeof(a)){case"AudioParam":return this._nodes[this._nodes.length-1].connect(a,b),this;case"string":a=this._instance.node(a),e=a._nodes[0];break;case"Node":e=a._nodes[0];break;case"AudioNode":e=a;break;default:throw new Error("Unknown node type passed to connect")}switch(!1){case"string"!=typeof b:this._nodes[this._nodes.length-1].connect(e[b],c);break;case"number"!=typeof b:this._nodes[this._nodes.length-1].connect(e,b,c)}return d?this:a},a.prototype.chain=function(a,b,c){if(null==b&&(b=0),null==c&&(c=0),this.debug(a,this.__typeof(a),typeof b),"AudioParam"===this.__typeof(a)&&"string"!=typeof b)throw new Error("Node.chain() can only target AudioParams when used with the signature .chain(target_node:Node, target_param_name:string)");return this.connect(a,b,c,!1)},a.prototype.to=function(a){switch(this.__typeof(a)){case"Node":return a._nodes[0];case"AudioNode":return a;default:throw new Error("Unknown node type passed to connect")}},a.prototype.from=a.prototype.to,a.prototype.expose_methods_of=function(a){var b,c,d;this.debug("exposing",a),c=[];for(b in a)if(d=a[b],null==this[b])switch(this.__typeof(d)){case"function":c.push(this[b]=d.bind(a));break;case"AudioParam":c.push(this[b]=d);break;case"string":case"number":c.push(function(a,b,c){return Object.defineProperty(a,c,{get:function(){return b[c]},set:function(a){return b[c]=a},enumerable:!0,configurable:!0})}(this,a,b));break;default:c.push(void 0)}return c},a.prototype.safely_disconnect=function(a,b,c,d){var e,f,g;switch(null==c&&(c=0),null==d&&(d=0),this.__typeof(a)){case"Node":f=a._nodes[a._nodes.length-1];break;case"AudioNode":case"AudioParam":f=a;break;default:throw new Error("Unknown node type passed to connect")}switch(this.__typeof(b)){case"Node":g=b._nodes[0];break;case"AudioNode":case"AudioParam":g=b;break;default:throw new Error("Unknown node type passed to connect")}try{f.disconnect(g,c,d)}catch(h){e=h,this.debug("ignored InvalidAccessError disconnecting "+g+" from "+f)}return this},a.prototype.disconnect=function(a,b,c){return null==b&&(b=0),null==c&&(c=0),this.safely_disconnect(this,a,b,c)},a.prototype.param=function(a,b){var c,d;if("object"===this.__typeof(a)){for(c in a)d=a[c],this.get_set(c,d);return this}return this.get_set(a,b),this},a.prototype.get_set=function(a,b){if(null!=this[a])switch(this.__typeof(this[a])){case"AudioParam":return null!=b?(this[a].value=b,this):this[a].value;default:return null!=b?(this[a]=b,this):this[a]}},a.prototype.debug=function(){var a;return a=1<=arguments.length?f.call(arguments,0):[],this._instance.config.debug?console.log.apply(console,a):void 0},a}(),a=function(a){function b(a,c){this._instance=a,null==c&&(c={}),c.node_type="Gain",b.__super__.constructor.apply(this,arguments),this.configure_from(c),this.insert_node(this.context.createGain(),0),this._nodes[0].gain.value=this._instance.config.default_gain,this.zero_node_setup(c)}return g(b,a),b}(c),d=function(b){function c(b,d){this._instance=b,null==d&&(d={}),d.node_type="Oscillator",c.__super__.constructor.apply(this,arguments),this.configure_from(d),this.insert_node(this.context.createOscillator(),0),this.zero_node_setup(d),this.insert_node(new a(this._instance,{connect_to_destination:this.config.connect_to_destination})),this._is_started=!1}return g(c,b),c.prototype.start=function(){return this._is_started?this._nodes[1].gain.value=1:(this._nodes[0].start(),this._is_started=!0),this},c.prototype.stop=function(){return this._nodes[1].gain.value=0,this},c}(c),e=function(a){function b(a,c){this._instance=a,null==c&&(c={}),c.node_type="StereoPanner",b.__super__.constructor.apply(this,arguments),this.configure_from(c),this.insert_node(this.context.createStereoPanner(),0),this.zero_node_setup(c)}return g(b,a),b}(c),b=function(){function b(a){this.initConfig=null!=a?a:{},this._BROWSER_CONSTRUCTOR=!1,this.context=this.create_context(),this._destination=this.context.destination,this.config={debug:!1,default_gain:.5},this.init(this.initConfig),this._nodes={}}return b.LEGAL_NODES={Oscillator:d,StereoPanner:e,Gain:a},b.prototype.init=function(a){var b,c,d,e;c=this.config,d=[];for(b in c)e=c[b],null!=a[b]?d.push(this.config[b]=a[b]):d.push(void 0);return d},b.prototype.create_context=function(){if(null!=window.AudioContext)return this._BROWSER_CONSTRUCTOR="AudioContext",new AudioContext;if(null!=window.webkitAudioContext)return this._BROWSER_CONSTRUCTOR="webkitAudioContext",new webkitAudioContext;throw new Error("This browser does not yet support the AudioContext API")},b.prototype.node=function(){var a,b,d,e,g;if(a=arguments[0],d=2<=arguments.length?f.call(arguments,1):[],!arguments.length)return new c(this);if("string"==typeof a){if(d.length)return this._nodes[a]=function(a,b,c){c.prototype=a.prototype;var d=new c,e=a.apply(d,b);return Object(e)===e?e:d}(c,[this,a].concat(f.call(d)),function(){});if(null!=(null!=(e=this._nodes)?e[a]:void 0))return this._nodes[a];throw new Error("No node found with id "+a)}return b=function(a,b,c){c.prototype=a.prototype;var d=new c,e=a.apply(d,b);return Object(e)===e?e:d}(c,[this].concat(f.call((g=[a]).concat.apply(g,d))),function(){}),this._nodes[b.id]=b},b}(),window.Mooog=b}).call(this);
//# sourceMappingURL=mooog.min.js.map